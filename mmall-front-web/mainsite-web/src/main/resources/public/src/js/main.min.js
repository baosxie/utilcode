function countDown(t,e){var i=t.val(),e=e,a=1,s=setInterval(function(){var o=e-a;a>e-1?(a=1,$(t).removeClass("btn-disable").attr("disabled",!1).val(i),clearInterval(s)):($(t).addClass("btn-disable").attr("disabled",!0).val("剩余时间("+o+")"),a++)},1e3)}function createPopup(t){var e="";e+="<div class='opacity'></div><div class='box  "+t+"'><div class='title'><b></b><span class='close'>X</span></div><div class='content'></div></div>",$(".popup").append(e)}function login(){createPopup("min-box"),$(".popup").popup("登录");var t="";t+="<div class='login-window'><input type='text' class='input-text input-max' value='邮箱/手机号/用户名' /><input type='password' class='input-text input-max' /><input type='button' value='登录' class='login-submit' /><p class='clearfix'><a href='#' class='l forget-pwd'>忘记密码</a><a href='#' class='r go-register'>免费注册</a></p><p class='other-login'>第三方登录</p><p><a href='#' class='wy-login'></a><a href='#' class='qq-login'></a><a href='#' class='wb-login'></a></p></div>",$(".popup").find(".content").append(t)}function getCurrentCity(){$.ajax({type:"GET",url:" /location/currentArea",async:!1,contentType:"application/json",data:{},success:function(t){200==t.code}})}function getCookie(t){var e=t,i="",a="",s=document.cookie;return s.length>0?(i=s.indexOf(e+"="),i>=0?(a=s.indexOf(";",i),a=a>=0?a:s.length,decodeURIComponent(s.substring(i+1+e.length,a))):null):void 0}function changeCity(){var t=$(".city-change .opacity"),e=$(".city-change .content"),i=(e.height(),e.width());$(".city-change").show(),t.css({width:bdoyW,height:bodyH}),e.css({left:(bdoyW-i)/2,top:(windowH-500)/2})}function setArea(t,e){$.ajax({type:"GET",url:"/section/s",async:!1,dataType:"json",data:{c:t,s:e},success:function(t){t.result&&($(".city-change").hide(),window.location.href="/")}})}function getCityInOrder(){$.ajax({type:"GET",url:"/location/cityInOrder",async:!1,dataType:"json",data:{},success:function(t){200==t.code&&(cities=t.result.list)}})}function createCityInOrder(t){for(var e="<div class='dist'><p>"+t+"</p><div class='cities'>",i=0;i<cities.length;i++)if(cities[i].key==t){var a=cities[i].value;if(0!=a.length)for(var s=0;s<a.length;s++)e+="<span data-code='"+a[s].id+"' onclick='clickCity(this);'>"+a[s].name+"</span>";else e+="<span>暂无城市</span>"}e+="&nbsp;</div></div>",cityInOrderBox.append(e)}function clickCity(t){var e=$(t).data("code"),i=$(t).html(),a=$(t).offset(),s=$(t).height(),o=$(t).width(),n=uparrow2.height();$(t).addClass("selected").siblings().removeClass(),locationCityID=e,locationCityName=i,createDistrict(e,1),uparrow2.css({top:a.top+s,left:a.left+o/2+5}).show(),areaFloatBox.css({top:a.top+s+n}).show()}function setChangeCityName(t,e){$(".region-select em").html(e).attr("data-code",t),$(".city-change .tit .cur em").html(e).attr("data-code",t)}function createDistrict(t,e){$.ajax({type:"GET",url:"/location/district",async:!1,dataType:"json",data:{code:t},success:function(t){if(200==t.code){areaFloatBox.empty(),districtDom="";for(var e=0;e<t.result.list.length;e++)districtDom+="<span data-code="+t.result.list[e].id+">"+t.result.list[e].name+"</span>";areaFloatBox.append(districtDom)}}})}function getCartNum(){cartNum.length>0&&$.ajax({cache:!1,type:"GET",url:" /cart/getcount",async:!1,dataType:"json",data:{},success:function(t){200==t.code&&cartNum.html(t.result)}})}function isLogin(){var t=getCookie("XYLUN"),e=getCookie("userNickName"),i=$(".is-login"),a=$(".no-login"),s=$(".username"),o=$(".loginout");null!=t?null==e?$.ajax({cache:!1,async:!1,type:"GET",url:" /profile/getUserInfo",dataType:"json",data:{},success:function(t){void 0==t.code?(o.remove(),i.hide(),a.show()):200==t.code?(e=t.result.nickname,getCartNum(),i.show(),a.hide(),s.html(e),$(".pull-down").show()):(o.remove(),i.hide(),a.show())}}):(getCartNum(),i.show(),a.hide(),s.html(e),$(".pull-down").show()):(o.remove(),i.hide(),a.show())}function accAdd(t,e){var i,a,s;try{i=t.toString().split(".")[1].length}catch(o){i=0}try{a=e.toString().split(".")[1].length}catch(o){a=0}return s=Math.pow(10,Math.max(i,a)),(t*s+e*s)/s}function accSubtr(t,e){var i,a,s;try{i=t.toString().split(".")[1].length}catch(o){i=0}try{a=e.toString().split(".")[1].length}catch(o){a=0}return s=Math.pow(10,Math.max(i,a)),((t*s-e*s)/s).toFixed(2)}function accMul(t,e){var i=0,a=t.toString(),s=e.toString();try{i+=a.split(".")[1].length}catch(o){}try{i+=s.split(".")[1].length}catch(o){}return Number(a.replace(".",""))*Number(s.replace(".",""))/Math.pow(10,i)}function accDiv(arg1,arg2){var r1,r2,t1=0,t2=0;try{t1=arg1.toString().split(".")[1].length}catch(e){}try{t2=arg2.toString().split(".")[1].length}catch(e){}with(Math)return r1=Number(arg1.toString().replace(".","")),r2=Number(arg2.toString().replace(".","")),r1/r2*pow(10,t2-t1)}function getBase(){(categorySideBox.length>0||categoryNavBox.length>0||bannerBox.length>0)&&$.ajax({type:"GET",url:"/index",async:!1,dataType:"json",data:{},success:function(t){locationCode=t.locationCode.id,locationName=t.locationCode.name,categoryList=t.categoryList,bannerList=t.promotionContent,null!=categoryList&&CreateCategory(categoryList),null!=bannerList&&bannerBox.length>0&&createBanner(bannerList)}})}function CreateCategory(t){for(var e=0;e<t.length;e++){firstDom+="<li class='itme"+(e+1)+"' data-id='"+t[e].id+"'><i></i><span><a href='javascript:void(0);' data-id='"+t[e].id+"' data-level='"+t[e].level+"'>"+t[e].name+"</a></span><em></em></li>",secondDom+="<li>";var i=t[e].subCategoryContentDTOs;if(null!=i){for(var a=0;a<i.length;a++){secondDom+="<dl><dt><a href='javascript:void(0);' data-id='"+i[a].id+"' data-level='"+ +i[a].level+"'>"+i[a].name+"</a></dt>";var s=i[a].subCategoryContentDTOs;if(null!=s)for(var o=0;o<s.length;o++)secondDom+="<dd><a href='javascript:void(0);' data-id='"+s[o].id+"-"+s[o].categoryNormalIds+"'>"+s[o].name+"</a></dd><dd>|</dd>";secondDom+="</dl>"}secondDom+="</li>"}}categorySideBox.append(firstDom),categoryNavBox.append(secondDom),categoryNavBox.find("dl").each(function(){$(this).find("dd:last").remove()})}function createBanner(t){for(var e=0;1>e;e++)bannerDom+="<li><a href='/activity/20150916/' target='_blank' style='background-image: url("+t[e].imgUrl+");'></a></li>";bannerBox.append(bannerDom)}function getCartListmini(){$.ajax({type:"GET",url:" /cart/listmini",async:!1,contentType:"application/json",data:{},success:function(t){if(200==t.code){var e=t.result.cartStoreList;if(null!=e){if(!(e.length>0))return;for(var i=t.result.cartInfoVO.totalPrice,a=0,s=0;s<e.length;s++)a+=e[s].skulist.length;cartListminiListBox.empty(),createCartListmini(e),getTotalNum(i,a)}}}})}function createCartListmini(t){for(var e="",i=0;i<t.length;i++){e+="<li><a href='"+t[i].storeUrl+"/' class='shop-name' target='_blank'>"+t[i].storeName+"</a>";for(var a=0;a<t[i].skulist.length;a++)e+="<div class='clearfix box'><img src='"+t[i].skulist[a].thumb+"'><div class='item'><a href='javascript:void(0);' class='title' data-id='"+t[i].skulist[a].productId+"'>"+t[i].skulist[a].name+"</a><p><b>¥"+t[i].skulist[a].cartPrice+"</b><em>x "+t[i].skulist[a].count+"</em></p></div></div>";e+="</li>"}cartListminiListBox.append(e)}function getTotalNum(t,e){caetListminiBottomBox.find("em i").html(e),caetListminiBottomBox.find("b i").html(t)}function getReplenishList(){$.ajax({type:"GET",url:" /replenish/list/",async:!1,contentType:"application/json",data:{},success:function(t){if(200==t.code){var e=t.result.list;null!=e&&(sideReplenishListBox.empty(),createReplenishList(e))}}})}function createReplenishList(t){for(var e="",i=0;i<t.length;i++){e+="<li><a href='/store/"+t[i].supplierId+"/' class='shop-name' target='_blank'>"+t[i].storeName+"</a>";for(var a=0;a<t[i].replenishVOList.length;a++){var s=t[i].replenishVOList[a],o=s.snapshot,o=JSON.parse(o);e+="<div class='clearfix box'><img src='"+o.picUrl+"'><div class='item'><a href='javascript:void(0);' class='title' data-id='"+s.productId+"'>"+o.productName+"</a><p><b>¥"+s.lastBuyPrice+"</b><em>x "+s.lastBuyNum+"</em></p></div></div>"}e+="</li>"}sideReplenishListBox.append(e)}var windowH=$(window).height(),windowW=$(window).width(),bodyH=$("body").height(),bdoyW=$("body").width();$(window).scroll(function(){$(document).scrollTop()>0?$(".gotop").fadeIn():$(".gotop").fadeOut()}),$.fn.gotop=function(){$(this).on("click",function(){$("body, html").animate({scrollTop:0},400)})},$(".gotop").gotop(),$.fn.inputClear=function(){$(this).on("focus",function(){$(this).addClass("input-focus"),$(this).val(" ")}),$(this).on("blur",function(){$(this).removeClass("input-focus");var t=this.defaultValue,e=$(this).val();e==t||" "==e?$(this).val(t):$(this).val(e)})},$(".input-clear").inputClear(),$.fn.tableUi=function(){var t={odd:"bg-odd",even:"bg-even",selected:"bg-selected"},e=$(this);e.find("tr:odd").addClass(t.odd),e.find("tr:even").addClass(t.even),e.find("tr").hover(function(){$(this).addClass(t.selected)},function(){$(this).removeClass(t.selected)})},$(".table-ui tbody").tableUi(),$.fn.checkAll=function(){$(this).on("click",function(){$(this).attr("checked")?($(".check-all-list").find("input[type='checkbox']").removeAttr("checked"),$(this).removeAttr("checked")):($(".check-all-list").find("input[type='checkbox']").prop("checked","true"),$(this).attr("checked","true"))})},$(".check-all").checkAll(),$.fn.popup=function(t){var e=$(this),i=$(window).height(),a=$("body").height(),s=$("body").width(),o=e.find(".opacity"),n=e.find(".box"),c=n.height(),d=n.width();o.css({width:s,height:a}),n.css({left:(s-d)/2,top:(i-c)/2}),e.find(".title b").html(t)},$(".popup").on("click",".close",function(){$(".popup").empty()});var locationCityName="",locationCityID="",locationAreaName="",cityNameEnd=0,cityIDEnd=0,areaNameEnd=0,obj=getCookie("MMALL_AREA");cityNameEnd=obj.indexOf("|"),locationCityName=obj.substring(0,cityNameEnd),cityIDEnd=obj.indexOf("|",cityNameEnd+1),locationCityID=obj.substring(cityNameEnd+1,cityIDEnd),areaNameEnd=obj.lastIndexOf("|"),locationAreaName=obj.substring(cityIDEnd+1,areaNameEnd),areaIDEnd=obj.indexOf("#"),locationAreaID=obj.substring(areaNameEnd+1,areaIDEnd);var currentState=$(window).scrollTop()<666,fixedTop=$(".fixed-top");$(window).scroll(function(){var t=$(window).scrollTop()<666;t!=currentState&&(t?(fixedTop.find(".category-nav").hide(),fixedTop.find(".category-side").hide(),fixedTop.find("dt").removeClass(),fixedTop.animate({top:-45},100)):fixedTop.animate({top:0},100),currentState=t)}),$(function(){$(".pull-down").hover(function(){$(this).toggleClass("active").find("dd").show()},function(){$(this).toggleClass("active").find("dd").hide()})}),$(".region-select em").html(locationCityName+"("+locationAreaName+")").attr("data-code",locationCityID);var districtBox=$(".current-area .ars"),districtDom="",cityInOrderBox=$(".city-change .other-city .common"),cityInOrderDom="",cities={},areaFloatBox=$(".city-change .area-float"),uparrow2=$(".city-change .uparrow2");$(".region-select em").click(function(){changeCity(),$(".city-change .tit span em").html(locationCityName).attr("data-code",locationCityID),createDistrict(locationCityID,0)}),$(".city-change .close").on("click",function(){$(".city-change").hide()}),$(".city-change .tit dd").on("click",function(){areaFloatBox.hide(),uparrow2.hide(),$(this).siblings().find(".uparrow").hide(),$(this).addClass("active").siblings().removeClass("active"),$(this).find(".uparrow").show(),$(this).hasClass("cur")?($(".con .current-area").show(),$(".con .other-city").hide()):($(".con .other-city").show(),$(".con .current-area").hide()),$(this).hasClass("oth")&&getCityInOrder()}),$(".city-change .current-area .ars, .city-change .area-float").on("click","span",function(){$("this").addClass("selected").siblings().removeClass("selected");var t=$(this).data("code");setChangeCityName(locationCityID,locationCityName),setArea(locationCityID,t)}),$(".other-city .tab dd").on("click",function(){if($(this).addClass("active").siblings().removeClass("active"),areaFloatBox.hide(),uparrow2.hide(),$(this).hasClass("hot-tab"))$(".other-city .hot").show(),$(".other-city .common").hide();else{$(".other-city .hot").hide(),$(".other-city .common").show();var t=$(this).html();if($(this).hasClass("y-z"))var e=t.split("·").join("").split("");else var e=t.split("");cityInOrderBox.empty();for(var i=0,a=e.length;a>i;i++)createCityInOrder(e[i])}}),$(".city-change .hot span").on("click",function(){clickCity(this)}),areaFloatBox.on("mouseleave",function(){$(this).hide(),uparrow2.hide()});var cartNum=$(".js-cart-num");isLogin(),$(".loginout").on("click",function(){var t=window.location.href;$.ajax({url:"/logout",type:"POST",data:{},success:function(e){window.location.href="/login?redirectURL="+encodeURIComponent(t)}})}),Number.prototype.add=function(t){return accAdd(t,this)},Number.prototype.subtr=function(t){return accSubtr(this,t)},Number.prototype.mul=function(t){return accMul(t,this)},Number.prototype.accDiv=function(t){return accDiv(this,t)},function(t){function e(e,i){var s=t("<div class='messagetip'></div>").appendTo("body");if(s.append("<div class='tiptop'><span class='close'></span></div><div class='tipinfo'>"+e+"</div>"),i){var o=t('<div class="tipbtn"></div>').appendTo(s);for(var n in i)"sure"==n?t('<input type="button" class = "sure message-btn" value="确定"/>').bind("click",i[n]).appendTo(o):t('<input type="button" class = "cancel message-btn" value="取消"/>').bind("click",i[n]).appendTo(o);o.wrap("<div class='tipbuttom'></div>")}return s.find(".tiptop span").click(function(){a(s)}),s}function i(t){var e=t.data("message");e.message.fadeIn(0),e.mask.css("display","block")}function a(t){if(t.data("message")){var e=t.data("message");e.message.remove(),e.mask.remove()}}function s(e){e.data("message").mask&&e.data("message").mask.remove(),e.data("message").mask=t('<div class="messageMask"></div>').css({zIndex:t.message.defaults.zIndex++,width:t(document).width(),height:t(document).height(),left:0,top:0}).appendTo(t(document.body))}t.message={alert:function(o,n,c,d){var r=null,l=null,h=t(window).height(),u=(t("body").height(),t("body").width());r=t.extend({},t.message.defaults,d||{});var f="<div>"+o+"</div>";switch(n){case"success":f='<div class="messageIcon messageSuccess"></div>'+f;break;case"fail":f='<div class="messageIcon messageFail"></div>'+f;break;case"info":f='<div class="messageIcon messageInfo"></div>'+f}var p={};p[t.message.defaults.ok]=function(){return a(l),c?(c(),!1):void 0};var l=e(f,p);l.data("message",{message:l}),l.width(r.width),l.find(".tipbuttom").width(r.width);var m=l.height();l.css({left:(u-r.width)/2,top:(h-m)/2}),s(l),l.css("z-index",t.message.defaults.zIndex++),i(l)},confirm:function(o,n,c,d){var r=null,l=null,h=t(window).height(),u=(t("body").height(),t("body").width());r=t.extend({},t.message.defaults,d||{});var f="<div>"+o+"</div>";switch(n){case"info":f='<div class="messageIcon messageInfo"></div>'+f;break;case"del":f='<div class="messageIcon messageDel"></div>'+f}var p={};p[t.message.defaults.ok]=function(){return a(l),c?(c(!0),!1):void 0},p[t.message.defaults.cancel]=function(){return a(l),c?(c(!1),!1):void 0};var l=e(f,p);l.data("message",{message:l}),l.width(r.width),l.find(".tipbuttom").width(r.width);var m=l.height();l.css({left:(u-r.width)/2,top:(h-m)/2}),s(l),l.css("z-index",t.message.defaults.zIndex++),i(l)}},t.message.defaults={width:350,zIndex:11,ok:"sure",cancel:"cancel"}}(jQuery);var windowH=$(window).height(),windowW=$(window).width(),bodyH=$("body").height(),bdoyW=$("body").width(),orderTitH=$(".fixed-side-order .tit").height(),orderBotH=$(".fixed-side-order .bottom").outerHeight(!0),replenishBotH=$(".fixed-side-replenish .bottom").outerHeight(!0),shopCard=$(".fixed-side .card"),shopReplenish=$(".fixed-side .replenish"),fixedSide=$(".fixed-side"),fixedSideOrder=$(".fixed-side-order"),fixedSideReplenish=$(".fixed-side-replenish"),fixOrdClose=fixedSideOrder.find(".close"),fixRepClose=fixedSideReplenish.find(".close");$(".fixed-side-order .list").css({height:windowH-orderTitH-orderBotH}),$(".fixed-side-replenish .list").css({height:windowH-orderTitH-replenishBotH}),shopCard.on("click",function(){$(this).siblings().removeClass("active"),$(this).hasClass("active")?($(this).removeClass("active"),fixedSide.animate({right:0},100),fixedSideOrder.attr("status","hide").animate({right:-280},100)):(getCartListmini(),$(this).addClass("active"),"show"==fixedSideReplenish.attr("status")&&fixedSideReplenish.attr("status","hide").animate({right:-280},100),fixedSide.animate({right:280},100),fixedSideOrder.attr("status","show").animate({right:0},100))}),fixOrdClose.on("click",function(){fixedSide.animate({right:0},100),fixedSideOrder.animate({right:-280},100),shopCard.removeClass("active")}),shopReplenish.on("click",function(){$(this).siblings().removeClass("active"),$(this).hasClass("active")?($(this).removeClass("active"),fixedSide.animate({right:0},100),fixedSideReplenish.attr("status","hide").animate({right:-280},100)):(getReplenishList(),$(this).addClass("active"),"show"==fixedSideOrder.attr("status")&&fixedSideOrder.attr("status","hide").animate({right:-280},100),fixedSide.animate({right:280},100),fixedSideReplenish.attr("status","show").animate({right:0},100))}),fixRepClose.on("click",function(){fixedSide.animate({right:0},100),fixedSideReplenish.animate({right:-280},100),shopReplenish.removeClass("active")}),fixedSide.find("li").on("mousemove",function(){$(this).find("p").show().animate({left:-90},100)}),fixedSide.find("li").on("mouseleave",function(){$(this).find("p").hide().animate({left:-100},1)});var firstDom="",secondDom="",categorySideBox=$(".category-side ul"),categoryNavBox=$(".category-nav ul"),bannerList,bannerDom="",bannerBox=$(".banner .pic ul");getBase(),$(".category-nav").on("click","a",function(){var t=$(this).data("id");window.location.href="/list/"+t}),$(function(){var t=$(".category-side"),e=($(".category-nav"),$(".category-wrap")),i=$(".main-category-box"),a=$(".main-category-top");t.on("mousemove","li",function(){var t=$(this).index();$(this).addClass("active").siblings().removeClass("active"),$(this).closest(".main-category").find(".category-nav").show().find("li").eq(t).addClass("active").siblings().removeClass("active")}),e.on("mouseleave",function(){t.find("li").removeClass("active"),$(this).find(".category-nav").hide().find("li").removeClass()}),i.find("dt").on("mousemove",function(){$(this).closest(".main-category").find(".category-side").show()}),i.find(".category-wrap").on("mouseleave",function(){$(this).find(".category-side, .category-nav").hide()}),a.find("dt").on("mousemove",function(){$(this).closest(".main-category").find(".category-side").show()}),a.find(".category-wrap").on("mouseleave",function(){$(this).find(".category-side, .category-nav").hide()})}),$(function(){function t(t){e=t.closest(".pro-box").find(".min-num.active").data("num"),i=t.closest(".pro-box").find(".num"),a=i.val()}var e,i,a,s=$(".js-pro-list");s.on("mousemove",".more",function(){$(this).addClass("active").closest(".pro-box").find(".shade").show()}),s.on("mouseleave",".more",function(){$(this).removeClass("active").closest(".pro-box").find(".shade").hide()}),s.on("mousemove",".min-num",function(){var t=$(this).data("num"),e=$(this).closest(".pro-box").find(".num");$(this).addClass("active").siblings().removeClass("active"),$(this).closest(".pro-box").find(".down").addClass("disable"),e.val(t)}),s.on("click",".up",function(){t($(this)),a++,i.val(a),a>e&&$(this).closest(".pro-box").find(".down").removeClass("disable")}),s.on("click",".down",function(){$(this).hasClass("disable")||(t($(this)),a--,i.val(a),e>=a&&$(this).closest(".pro-box").find(".down").addClass("disable"))}),s.on("blur",".num",function(){t($(this)),e>=a?(i.val(e),$(this).closest(".pro-box").find(".down").addClass("disable")):i.val(a)})});var proList=$(".pro-list");proList.on("mouseenter",".pro-box",function(){$(this).css({position:"absolute",boxShadow:"2px 2px 2px #dfdfdf"}).addClass("active")}),proList.on("mouseleave",".pro-box",function(){$(this).css({position:"static",boxShadow:"0 0 0 #dfdfdf"}).removeClass("active")});var cartListminiListBox=$(".fixed-side-order .list ul"),caetListminiBottomBox=$(".fixed-side-order .bottom");cartListminiListBox.on("click",".title",function(){var t=$(this).data("id");window.location.href="/product/detail?skuId="+t});var sideReplenishListBox=$(".fixed-side-replenish .list ul"),sideReplenishBottomBox=$(".fixed-side-replenish .bottom");sideReplenishListBox.on("click",".title",function(){var t=$(this).data("id");window.location.href="/product/detail?skuId="+t}),$(".sub-input").on("click",function(){var t=$.trim($(this).closest(".search").find("input").val());""!=t&&(window.location.href="/search?"+t)}),$(document).on("keyup",function(t){var e=t.which;if(13==e){var i=$(".top .search input").is(":focus"),a=$(".fixed-top .search .sear-input").is(":focus");if(i){var s=$.trim($(".top .search input").val());if(""==s)return;window.location.href="/search?"+s}else if(a){var s=$.trim($(".fixed-top .search .sear-input").val());if(""==s)return;window.location.href="/search?"+s}}});